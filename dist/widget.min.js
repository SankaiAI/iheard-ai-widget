window.IHEARD_TEXT_AGENT_URL="https://iheard-ai-text-agent-server-production.up.railway.app",window.IHEARD_VOICE_AGENT_URL="https://endearing-playfulness-production.up.railway.app",window.IHEARD_WIDGET_URL="https://iheard-ai-widget.pages.dev/widget.js",window.IHEARD_BUILD_ENV="development",window.IHEARD_BUILD_TIME="2025-08-04T09:59:29.688Z",function(){"use strict";let e=!1;let i=!1;if(void 0===window.LiveKit){const e=document.createElement("script");e.src="https://unpkg.com/livekit-client@2.0.0/dist/livekit-client.umd.js",e.async=!0,e.onload=()=>{},e.onerror=()=>{},document.head.appendChild(e)}else i=!0;async function t(){try{const n=document.getElementById("iheard-ai-widget");n&&n.remove();const o=await async function(){try{const i=document.currentScript||document.querySelector('script[src*="widget.min.js"]')||document.querySelector('script[src*="widget.js"]')||Array.from(document.scripts).find(e=>e.src.includes("widget.min.js"))||Array.from(document.scripts).find(e=>e.src.includes("widget.js"));let t="";if(i&&i.src){const e=new URL(i.src),n=e.pathname.replace("/widget.js","").replace("/widget.min.js","");t=e.origin+n,i.src,e.origin,e.pathname}else t="https://iheard-ai-widget.pages.dev";const[n,o,d,r,a,s]=await Promise.all([import(`${t}/styles/index.js`),import(`${t}/core/index.js`),import(`${t}/voice/index.js`),import(`${t}/ui/index.js`),import(`${t}/api/index.js`),import(`${t}/utils/index.js`)]);return window.iHeardModules={styles:n,core:o,voice:d,ui:r,api:a,utils:s},e=!0,window.iHeardModules}catch(e){throw new Error("Module loading failed: "+e.message)}}();i||await new Promise((e,t)=>{function n(){return window.LiveKit||window.livekit||window.LiveKitClient||window.livekitClient||window.LivekitClient}if(n()){const t=n();return window.LiveKit=t,i=!0,void e()}const o=setInterval(()=>{const t=n();t&&(clearInterval(o),window.LiveKit=t,i=!0,e())},100);setTimeout(()=>{clearInterval(o),Object.keys(window).filter(e=>e.toLowerCase().includes("live")),t(new Error("LiveKit client failed to load within timeout"))},1e4)}),await o.core.initializeConfiguration();const d=o.ui.createWidgetHTML(),r=function(e,i){const t=document.createElement("style");return t.textContent=i,document.head.appendChild(t),e}(d,o.styles.createAllStyles());document.body.appendChild(r),o.ui.setupEventListeners(r),o.ui.setupWindowEventListeners(),o.ui.setupKeyboardEventListeners(),o.core.widgetConfig.voiceEnabled&&await o.voice.initializeVoiceSystem();const a=o.core.getAgentIdFromUrl();if(a){if("recreate"===await o.api.loadAgentConfig(a))return r.remove(),void setTimeout(()=>t(),100)}o.ui.updateWidgetAppearance(r),a&&o.core.widgetConfig.isActive&&o.api.startConfigPolling(a),o.utils.logInfo("Widget initialized",{agentId:a,voiceEnabled:o.core.widgetConfig.voiceEnabled,chatEnabled:o.core.widgetConfig.chatEnabled,modulesLoaded:Object.keys(o)})}catch(e){try{window.iHeardModules?.utils?.logError?.("Widget initialization failed",e,"Widget")}catch(e){}!function(e){const i=`\n      <div class="iheard-widget-container" style="\n        position: fixed !important;\n        bottom: 20px !important;\n        right: 20px !important;\n        z-index: 999999 !important;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif !important;\n      ">\n        <div class="iheard-widget-button" style="\n          width: 60px !important;\n          height: 60px !important;\n          border-radius: 50% !important;\n          background: #ef4444 !important;\n          color: white !important;\n          border: none !important;\n          cursor: pointer !important;\n          display: flex !important;\n          align-items: center !important;\n          justify-content: center !important;\n          font-size: 24px !important;\n          box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3) !important;\n        ">\n          ⚠️\n        </div>\n        <div class="error-message" style="\n          position: absolute !important;\n          bottom: 70px !important;\n          right: 0 !important;\n          background: white !important;\n          border: 1px solid #e5e7eb !important;\n          border-radius: 8px !important;\n          padding: 12px !important;\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;\n          max-width: 250px !important;\n          font-size: 14px !important;\n          color: #374151 !important;\n          display: none !important;\n        ">\n          <div style="font-weight: bold; margin-bottom: 8px;">Widget Error</div>\n          <div>${e||"Failed to load widget modules"}</div>\n          <div style="margin-top: 8px; font-size: 12px; color: #6b7280;">\n            Please refresh the page or contact support.\n          </div>\n        </div>\n      </div>\n    `,t=document.createElement("div");t.id="iheard-ai-widget-fallback",t.innerHTML=i;const n=t.querySelector(".iheard-widget-button"),o=t.querySelector(".error-message");n.addEventListener("click",()=>{o.style.display="none"===o.style.display?"block":"none"}),document.body.appendChild(t)}(e.message)}}function n(){window.iHeardModules?.api?.stopConfigPolling&&window.iHeardModules.api.stopConfigPolling(),window.iHeardModules?.voice?.disconnectFromLiveKit&&window.iHeardModules.voice.disconnectFromLiveKit();const e=document.getElementById("iheard-ai-widget"),i=document.getElementById("iheard-ai-widget-fallback");e&&e.remove(),i&&i.remove(),window.iHeardModules?.utils?.storage&&window.iHeardModules.utils.storage.clear()}window.iHeardAI={init:t,cleanup:n,reload:()=>{n(),setTimeout(t,100)},getModules:()=>window.iHeardModules,getConfig:()=>window.iHeardModules?.core?.widgetConfig,enableDebug:()=>window.iHeardModules?.utils?.enableDebugMode?.(),disableDebug:()=>window.iHeardModules?.utils?.disableDebugMode?.(),updateConfig:e=>{if(window.iHeardModules?.core?.updateConfig){if(window.iHeardModules.core.updateConfig(e),window.iHeardModules?.ui?.updateWidgetAppearance){const e=document.getElementById("iheard-ai-widget");e&&window.iHeardModules.ui.updateWidgetAppearance(e)}return!0}return!1},isInitialized:()=>!!(window.iHeardModules&&window.iHeardModules.core&&window.iHeardModules.ui&&document.getElementById("iheard-ai-widget"))},window.iHeardAIWidget=window.iHeardAI,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t(),window.addEventListener("beforeunload",n)}();